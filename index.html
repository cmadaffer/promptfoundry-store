<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PromptFoundry — All-Access Prompt Library</title>
  <meta name="description" content="Premium prompt kits for revenue teams. Unlock All-Access for $99/month."/>
  <link rel="icon" href="/favicon.ico"/>
  <meta property="og:title" content="PromptFoundry — All-Access Prompt Library"/>
  <meta property="og:description" content="Unlock the full prompt library for $99/month. Cancel anytime."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="/">
  <style>
    :root{--bg:#0b0d12;--card:#121520;--ink:#e8ebf3;--muted:#9aa3b2;--acc:#82b1ff;--line:#1c2230}
    *{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:1200px;margin:0 auto;padding:32px}
    .hero{display:grid;grid-template-columns:1.3fr 1fr;gap:32px;align-items:center;margin:16px 0 24px}
    .h1{font-size:40px;line-height:1.2;margin:0 0 12px}
    .sub{color:var(--muted);margin:0 0 16px}
    .cta{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .btn{background:var(--acc);color:#0b0d12;border:0;border-radius:10px;padding:12px 18px;font-weight:700;text-decoration:none;display:inline-flex;align-items:center;gap:8px}
    .btn.sec{background:#202737;color:var(--ink)}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin:24px 0}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:700}
    .price{color:var(--muted);font-size:14px}
    .muted{color:var(--muted)}
    .footer{margin:40px 0 0;padding:24px 0;border-top:1px solid var(--line);color:var(--muted);display:flex;gap:16px;flex-wrap:wrap}
    .pill{font-size:12px;background:#192033;color:#a7b3c9;border:1px solid var(--line);padding:2px 8px;border-radius:999px}
    .hide{display:none}
    .blur{filter:blur(6px)}
    .right{background:linear-gradient(135deg,#111726,#0f1a2d);border:1px solid var(--line);border-radius:16px;padding:16px}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
    .modal .panel{width:min(520px,92vw);background:#0e1320;border:1px solid var(--line);border-radius:16px;padding:24px}
    .input{width:100%;padding:12px;border-radius:10px;border:1px solid var(--line);background:#0b0f1a;color:#e8ebf3}
    @media(max-width:980px){.hero{grid-template-columns:1fr}.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <script>
    // ----- CONFIG -----
    const API_BASE = "https://your-api.onrender.com"; // << set this to your API URL
    const PREVIEW_LIMIT = 3;                            // items visible before unlock
    const LS_KEY = "pf_license";

    window.PF = {
      unlocked: false,
      token: null,
      async verify(token) {
        const r = await fetch(`${API_BASE}/api/license/verify?token=${encodeURIComponent(token)}`);
        const j = await r.json();
        return j.ok;
      },
      async load() {
        const saved = localStorage.getItem(LS_KEY);
        if (saved) {
          try {
            const ok = await PF.verify(saved);
            if (ok) { PF.unlocked = true; PF.token = saved; }
          } catch {}
        }
      }
    };
  </script>

  <div class="wrap">
    <header class="hero">
      <div>
        <h1 class="h1">PromptFoundry</h1>
        <p class="sub">A premium prompt library for growth and ops teams — <strong>All-Access for $99/month</strong>. Cancel anytime.</p>
        <div class="cta">
          <a class="btn" href="#" id="buyBtn">Subscribe — $99/m</a>
          <button class="btn sec" id="unlockBtn">Unlock Pro (Have a key?)</button>
          <span class="pill" id="statusPill">Locked</span>
        </div>
      </div>
      <div class="right">
        <strong>What you get</strong>
        <ul class="muted">
          <li>All current & future prompt kits</li>
          <li>Copy-ready prompts + how-to notes</li>
          <li>1-click export (JSON/CSV)</li>
          <li>Cancel anytime</li>
        </ul>
      </div>
    </header>

    <section id="library">
      <h3>Library</h3>
      <div class="grid" id="grid"></div>
    </section>

    <section id="pricing">
      <h3>Pricing</h3>
      <div class="card">
        <div class="title">All-Access</div>
        <div class="price">$99/month — unlimited access, cancel anytime</div>
      </div>
    </section>

    <footer class="footer">
      <a href="/terms.html">Terms</a>
      <a href="/privacy.html">Privacy</a>
      <a href="/refund.html">Refund</a>
      <a href="/contact.html">Contact</a>
      <span>© <span id="y"></span> PromptFoundry</span>
    </footer>
  </div>

  <!-- Unlock Modal -->
  <div class="modal" id="unlockModal" aria-hidden="true">
    <div class="panel">
      <h3>Unlock Pro</h3>
      <p class="muted">Paste your license key to unlock the full library.</p>
      <input id="keyInput" class="input" placeholder="XXXXXXXXXXXX-XXXXXXXX"/>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button class="btn" id="applyKey">Unlock</button>
        <button class="btn sec" id="cancelKey">Cancel</button>
      </div>
      <p class="muted" id="keyMsg" style="margin-top:8px"></p>
    </div>
  </div>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();

    const modal = document.getElementById("unlockModal");
    const openModal = () => { modal.style.display = "flex"; };
    const closeModal = () => { modal.style.display = "none"; };

    document.getElementById("unlockBtn").onclick = openModal;
    document.getElementById("cancelKey").onclick = closeModal;
    document.getElementById("applyKey").onclick = async () => {
      const key = document.getElementById("keyInput").value.trim();
      const msg = document.getElementById("keyMsg");
      msg.textContent = "Verifying…";
      try {
        const ok = await PF.verify(key);
        if (ok) {
          localStorage.setItem(LS_KEY, key);
          PF.unlocked = true; PF.token = key;
          msg.textContent = "Unlocked!";
          render();
          setTimeout(closeModal, 400);
        } else {
          msg.textContent = "Invalid or inactive key.";
        }
      } catch {
        msg.textContent = "Verification failed. Try again.";
      }
    };

    document.getElementById("buyBtn").onclick = (e) => {
      e.preventDefault();
      window.location.href = `${API_BASE}/api/checkout`;
    };

    async function fetchLibrary() {
      try {
        const r = await fetch("./library.json", { cache: "no-store" });
        if (!r.ok) throw 0;
        return await r.json();
      } catch {
        // Minimal fallback if library.json isn't available
        return {
          items: [
            { id:"sample", category:"Demo", title:"Sample Prompt", tags:["demo"], price:0,
              prompt:"This is a demo prompt. Unlock All-Access to see the full library." }
          ]
        };
      }
    }

    function cardHtml(item, locked) {
      const prompt = locked ? `<div class="blur">${item.prompt}</div>` : `<pre style="white-space:pre-wrap">${item.prompt}</pre>`;
      return `
        <div class="card">
          <div class="title">${item.title}</div>
          <div class="muted">${item.category} · ${item.tags?.slice(0,3).join(", ") || ""}</div>
          <div>${prompt}</div>
          <div class="muted">${locked ? "Locked — subscribe to view." : "Copy-ready"}</div>
        </div>`;
    }

    let LIB = null;
    async function render() {
      if (!LIB) LIB = await fetchLibrary();
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      const items = Array.isArray(LIB) ? LIB : (LIB.items || []);
      const locked = !PF.unlocked;
      const view = locked ? items.slice(0, PREVIEW_LIMIT) : items;
      view.forEach(item => grid.insertAdjacentHTML("beforeend", cardHtml(item, locked)));

      document.getElementById("statusPill").textContent = locked ? "Locked" : "Unlocked";
      document.getElementById("statusPill").className = "pill " + (locked ? "" : "unlocked");
    }

    (async () => {
      await PF.load();
      await render();
    })();
  </script>
</body>
</html>
